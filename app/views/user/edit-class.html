<div class="container">

  <div ng-include="'user/navs/user-nav.html'"></div>

  <uib-tabset active="userEditClass.tabIndex" vertical="true" type="pills" class="panel-blue clearfix account-wrapper">

    <uib-tab index="0">
      <uib-tab-heading>
        <div class="strong heading-font font-big">The Basics</div>
        <div>Name, category, price and size</div>
      </uib-tab-heading>

      <!-- The Basics -->
      <div class="account-content-wrapper">

        <div class="account-heading pb4 mb4">
          <h2 class="heading-font text-center uppercase m0 mb1">The basics</h2>
          <p class="text-center font-big m0">Edit the basic details about your class</p>
        </div>

          <form name="userEditClass.basicsForm" ng-submit="userEditClass.editClassBasics($event)" class="form-horizontal">
            <fieldset>

              <div class="form-group">
                <label class="control-label">Name</label>
                <div>
                  <input ng-model="userEditClass.classData.title" type="text" name="title" class="form-control form-full" placeholder="Class name" required/>
                </div>
              </div>

              <div class="form-group">
                <label class="control-label">Category</label>
                <div>
                  <select ng-model="userEditClass.classData.category" ng-change="userEditClass.classCategory(userEditClass.classData.category.id)" class="form-control form-full" ng-options="category as category.title for category in userEditClass.categories track by category.id" required>
                    <option value="">-- Select Category --</option>
                  </select>
                </div>
              </div>

              <div ng-repeat="category in userEditClass.categories" ng-if="category.id == userEditClass.subCategory && category.subcats[0]" class="form-group">
                  <label class="control-label">Sub category</label>
                  <div>
                    <select ng-model="userEditClass.classData.subcategory" class="form-control form-full" ng-options="subCategory as subCategory.title for subCategory in category.subcats track by subCategory.id">
                      <option value="">-- Select Sub Category --</option>
                    </select>
                  </div>
              </div>

              <div class="form-group">
                <label class="control-label">Price</label>
                <div class="tooltip-wrapper">
                  <div class="tooltip-button question-button">
                    <span>?</span>
                  </div>
                  <span class="tooltip top question">
                    <div class="tooltip-inner">
                      Per person
                    </div>
                  </span>
                </div>

                <div class="custom-radio-wrapper">
                  <div class="col-md-3">
                    <label class="btn btn-default btn-block" ng-model="userEditClass.classData.price" uib-btn-radio="'0.00'" ng-click="userEditClass.customPrice = false">Free</label>
                  </div>
                  <div class="col-md-2">
                    <label class="btn btn-default btn-block" ng-model="userEditClass.classData.price" uib-btn-radio="'10.00'" ng-click="userEditClass.customPrice = false">$10</label>
                  </div>
                  <div class="col-md-2">
                    <label class="btn btn-default btn-block" ng-model="userEditClass.classData.price" uib-btn-radio="'20.00'" ng-click="userEditClass.customPrice = false">$20</label>
                  </div>
                  <div class="col-md-2">
                    <label class="btn btn-default btn-block" ng-model="userEditClass.classData.price" uib-btn-radio="'30.00'" ng-click="userEditClass.customPrice = false">$30</label>
                  </div>
                  <div class="col-md-3">
                    <label class="btn btn-default btn-block" ng-model="userEditClass.classData.price" uib-btn-radio="'custom'" ng-click="userEditClass.customPrice = true; userEditClass.focusPrice()" ng-if="!userEditClass.customPrice">Custom</label>
                  </div>
                  <div class="col-md-3">
                    <input ng-model="userEditClass.priceInput" type="number" min="0" class="form-control form-full price-input" ng-if="userEditClass.customPrice" />
                  </div>
                </div>

              </div>

              <div class="form-group">

                <label class="control-label">Size</label>
                <div class="tooltip-wrapper">
                  <div class="tooltip-button question-button">
                    <span>?</span>
                  </div>
                  <span class="tooltip top question">
                    <div class="tooltip-inner">
                      Max size
                    </div>
                  </span>
                </div>

                <div class="custom-radio-wrapper">
                  <div class="col-md-1">
                    <label class="btn btn-default btn-block" ng-model="userEditClass.classData.size" uib-btn-radio="'1'" ng-click="userEditClass.customSize = false">1</label>
                  </div>
                  <div class="col-md-1">
                    <label class="btn btn-default btn-block" ng-model="userEditClass.classData.size" uib-btn-radio="'2'" ng-click="userEditClass.customSize = false">2</label>
                  </div>
                  <div class="col-md-1">
                    <label class="btn btn-default btn-block" ng-model="userEditClass.classData.size" uib-btn-radio="'5'" ng-click="userEditClass.customSize = false">5</label>
                  </div>
                  <div class="col-md-3">
                    <label class="btn btn-default btn-block" ng-model="userEditClass.classData.size" uib-btn-radio="'10'" ng-click="userEditClass.customSize = false">10</label>
                  </div>
                  <div class="col-md-3">
                    <label class="btn btn-default btn-block" ng-model="userEditClass.classData.size" uib-btn-radio="'20'" ng-click="userEditClass.customSize = false">20</label>
                  </div>
                  <div class="col-md-3">
                    <label class="btn btn-default btn-block" ng-model="userEditClass.classData.size" uib-btn-radio="'custom'" ng-click="userEditClass.customSize = true; userEditClass.focusSize()" ng-if="!userEditClass.customSize">Custom</label>
                  </div>
                  <div class="col-md-3">
                    <input ng-model="userEditClass.sizeInput" type="number" min="1" class="form-control form-full size-input" ng-if="userEditClass.customSize" />
                  </div>
                </div>

              </div>

              <div class="form-group">
                <button type="submit" class="btn btn-primary btn-block" ng-disabled="userEditClass.basicsForm.$invalid">
                  <span class="text">Update basics</span>
                  <span class="text-success">Basics updated</span>
                  <span class="text-fail">Details update failed</span>
                </button>
              </div>

            </fieldset>
          </form>

      </div>

    </uib-tab>





    <uib-tab index="1">
      <uib-tab-heading>
        <div class="strong heading-font font-big">The Details</div>
        <div>Brief and description</div>
      </uib-tab-heading>

      <!-- The Details -->
      <div class="account-content-wrapper account-content-wrapper-wider">

        <div class="account-heading pb4 mb4">
          <h2 class="heading-font text-center uppercase m0 mb1">
            The details
          </h2>
          <p class="text-center font-big m0">
            <span ng-if="!fromAddClass">
              You can easily edit the basic details using the navigation on the left
            </span>
            <span ng-if="fromAddClass">
              Great you have created <strong>{{ userEditClass.classData.title }}</strong>, now lets add in some more detail about your class. The more information you add the more successful your class will be, so get creative with your descriptions!
            </span>
          </p>
        </div>

        <form name="detailsForm" ng-submit="userEditClass.editClassDetails($event)" class="form-horizontal" novalidate>

            <div class="form-group">
              <label class="control-label">Short description</label>
              <div>
                <textarea name="shortDescription" ng-model="userEditClass.classData.brief" class="form-control form-full" rows="3" ng-minlength="50" ng-maxlength="200" placeholder="Short description" required></textarea>

                <p class="panel-error p1 text-center font-bold" ng-show="detailsForm.shortDescription.$error.required && !detailsForm.shortDescription.$pristine">This field is required</p>
                <p class="panel-error p1 text-center font-bold" ng-show="detailsForm.shortDescription.$error.minlength">Too short, please write a bit more</p>
                <p class="panel-error p1 text-center font-bold" ng-show="detailsForm.shortDescription.$error.maxlength">Too long, please write less</p>

              </div>
            </div>

            <div class="form-group">
              <label class="control-label">Main description</label>
              <div>
                <textarea name="mainDescription" ng-model="userEditClass.classData.description" class="form-control form-full" rows="10" ng-minlength="50" ng-maxlength="2000" placeholder="Main description" required></textarea>

                <p class="panel-error p1 text-center font-bold" ng-show="detailsForm.mainDescription.$error.required && !detailsForm.mainDescription.$pristine">This field is required</p>
                <p class="panel-error p1 text-center font-bold" ng-show="detailsForm.mainDescription.$error.minlength">Too short, please write a bit more</p>
                <p class="panel-error p1 text-center font-bold" ng-show="detailsForm.mainDescription.$error.maxlength">Too long, please write less</p>

              </div>
            </div>

            <div class="form-group">
              <button type="submit" class="btn btn-primary btn-block" ng-disabled="detailsForm.$invalid">
                <span class="text">Update details</span>
                <span class="text-success">Details updated</span>
                <span class="text-fail">Details update failed</span>
              </button>
            </div>

        </form>

      </div>

    </uib-tab>



    <uib-tab index="2">
      <uib-tab-heading>
        <div class="strong heading-font font-big">The Photos</div>
        <div>Cover photo and class photos</div>
      </uib-tab-heading>

      <!-- The Details -->
      <div class="account-content-wrapper account-content-wrapper-wider">

        <div class="account-heading pb4 mb4">
          <h2 class="heading-font text-center uppercase m0 mb1">
            The Photos
          </h2>
          <p class="text-center font-big m0">
            Make your class page stand out by adding a class page and add additional images to show off what your class has to offer!
          </p>
        </div>

            <div class="form-group">
              <label class="control-label">Cover photo</label>
              <div ng-repeat="photo in userEditClass.classData.photos" ng-if="photo.isMain == 1">
                <img class="img-responsive" ng-src="{{imageUrl}}{{photo.src}}" />
              </div>
            </div>

            <div class="form-group">
              <label class="control-label">Class photos</label>

              <ul class="clearfix list-unstyled photo-gallery">
                <li ng-repeat="photo in userEditClass.classData.photos">
                  <div class="background-image" style="background-image: url('{{imageUrl}}{{photo.src}}')">
                    <span ng-click="photo.isMain == 1 || userEditClass.imageCover(photo.id)" class="icon icon-favorite" ng-class="{'active':photo.isMain == 1}"></span>
                    <span ng-click="userEditClass.imageRemove(photo.id, $event)" class="icon icon-bin"></span>
                  </div>
                </li>

                <!-- Uploading images -->
                <li ng-repeat="f in userEditClass.files">
                  <div class="background-image" style="background-image: url('{{f | ngfDataUrl}}')"></div>
                  <div class="image-progress-bar">
                    <div class="text">
                      <strong>{{f.progress}}%</strong> Uploaded
                    </div>
                    <div class="progress-wrapper">
                      <div style="width:{{f.progress}}%"></div>
                    </div>
                  </div>
                </li>
              </ul>

              <button class="btn btn-alternative btn-block mt3" ngf-select="userEditClass.uploadFiles($files, $invalidFiles)" multiple accept="image/*" ngf-max-size="5MB">
                Add new photos
              </button>

              <ul class="list-unstyled">
                <li ng-repeat="f in userEditClass.errFiles">
                  {{f.name}} {{f.$error}} {{f.$errorParam}}
                </li>

              </ul>

            </div>

      </div>

    </uib-tab>



    <uib-tab index="3">
      <uib-tab-heading>
        <div class="strong heading-font font-big">The Location</div>
        <div>Venue and facilities</div>
      </uib-tab-heading>

      <!-- The Location -->
      <div class="account-content-wrapper">

        <div class="account-heading pb4 mb4">
          <h2 class="heading-font text-center uppercase m0 mb1">
            The Location
          </h2>
          <p class="text-center font-big m0">
            Select an existing venue or add a new one, don't forget to add the facilities!
          </p>
        </div>

        <div class="form-group">
          <div class="">
            Existing venues
          </div>
          <div class="">
            Add venue
          </div>

          <!-- Add location -->
          <form name="venueForm" ng-submit="userEditClass.addClassVenue($event)" class="form-horizontal" novalidate>

              <div class="form-group">
                <label class="control-label">Name</label>
                <div>
                  <input type="text" name="name" ng-model="userEditClass.venueData.title" class="form-control form-full" placeholder="e.g. Home, Sydney Park, Rockdale Bakery" required>

                  <p class="panel-error p1 text-center font-bold" ng-show="venueForm.name.$error.required && !venueForm.name.$pristine">Venue name is required</p>
                </div>
              </div>

              <div class="form-group">
                <label class="control-label">Location</label>
                <div>
                  <input type="text" name="location" class="form-control form-full" placeholder="Start typing venue address" ng-autocomplete ng-model="userEditClass.venueLocation" options="userEditClass.venueLocationOptions" details="userEditClass.venueLocationDetails" required>

                  <p class="panel-error p1 text-center font-bold" ng-show="venueForm.location.$error.required && !venueForm.location.$pristine">Venue name is required</p>
                </div>
              </div>

              <div class="form-group">
                <label class="control-label">Capacity</label>
                <div>
                  <input type="number" name="capacity" ng-model="userEditClass.venueData.capacity" class="form-control form-full" placeholder="What capacity is your venue?" required>

                  <p class="panel-error p1 text-center font-bold" ng-show="venueForm.capacity.$error.required && !venueForm.capacity.$pristine">Venue capacity is required</p>
                </div>
              </div>

              <div class="form-group">
                <button type="submit" class="btn btn-primary btn-block" ng-disabled="venueForm.$invalid">
                  <span class="text">Add location</span>
                  <span class="text-success">Location added</span>
                  <span class="text-fail">Location add failed</span>
                </button>
              </div>

          </form>

        </div>

      </div>


    </uib-tab>





    <uib-tab index="4">
      <uib-tab-heading>
        <div class="strong heading-font font-big">The Dates</div>
        <div>Calendar and times</div>
      </uib-tab-heading>

      <!-- The Dates -->
      <div class="panel account-content-wrapper block">

        <div class="panel-heading">

          <h2 class="panel-title text-center">
            <span>
              Add your class dates and times
            </span>
          </h2>
          <p class="text-center">
            <span>
              Simply add your date and time and click save
            </span>
          </p>

        </div>

        <div class="panel-body">
          <form name="editClassDetailsForm" ng-submit="userEditClass.editClassDates()" class="form-horizontal">
            <fieldset>

              <div class="form-group">
                <label class="control-label">Date</label>
                <div>
                  <div uib-datepicker ng-model="userEditClass.classDate" datepicker-options="{showWeeks: false}"></div>
                </div>
              </div>

              <div class="form-group">
                <label class="control-label">Time</label>
                <div>
                  <div uib-timepicker ng-model="userEditClass.classTime" hour-step="userEditClass.hstep" minute-step="userEditClass.mstep" show-meridian="true"></div>
                </div>
              </div>

              <div class="form-group">
                <label class="control-label">Duration</label>
                <div>
                  <select name="classDuration"
      ng-options="option.name for option in userEditClass.classDuration.availableOptions track by option.id"
      ng-model="userEditClass.classDuration.selectedOption"></select>
                </div>
              </div>

              <div class="form-group">
                <button type="submit" class="btn btn-primary btn-block">Add date</button>
              </div>

            </fieldset>

          </form>

        </div>
      </div>

      <ul class="date-data list-group">
        <li class="list-group-item" ng-repeat="date in userEditClass.classData.dates">
          <strong>{{date.classDate | date: 'd MMM yyyy'}}</strong>
          <ul class="list-unstyled" ng-repeat="time in date.times">
            <li class="list-group-item">
              {{time.startTime}} - {{time.endTime}}
              <div class="italic" ng-click="userEditClass.deleteClassTime(date.classDate, time.startTime, time.endTime)">
                delete
              </div>
            </li>
          </ul>
        </li>
      </ul>

    </uib-tab>





  </uib-tabset>

</div>
